$(document).ready(function(){var enter=false;$(document).keypress(function(event){var keycode=(event.keyCode?event.keyCode:event.which);if(keycode=='13'){$('.sendButton').click();enter=true;}});if((getDeviceWidth()<=480)){$(".chat-message").css({"width":"100%","height":"100%"});$(".chat-arae").css({"width":"100%","height":"100%"});$(".chat-cross").css("display","none");}
var isChatOpen;var issueId;var subIssueId;var userName;var userPhone;var userCity;var userZone;var userEmail;var userComment;var searchTerm;var isFirsttime=true;var isId;setTimeout(function(){if(getDeviceWidth()<=480&&isChatOpen){$(".chat-cross").css("display","none");}else{$(".chat").css("display","block");}
$(".chat").css({"right":"0px"}).animate({"right":"15px"},300,'linear');$(".chat-cross").css({"right":"0px"}).animate({"right":"15px"},300,'linear');},5000);setTimeout(function(){if($('.chat-message').css('display')=='none'){if($('.chat-cross').css('display')=='none'){if((getDeviceWidth()<=480)){$(".notification-count").css({"display":"block","bottom":"62px"}).text(1);}else{$(".notification-count").css({"display":"block","bottom":"75px"}).text(1);}}}},5500);setTimeout(function(){if($('.chat-message').css('display')=='none'){if($('.chat-cross').css('display')=='none'){$(".notification-count").text();if((getDeviceWidth()<=480)){$(".notification-count").css({"display":"block","bottom":"62px"}).text(2);}else{$(".notification-count").css({"display":"block","bottom":"75px"}).text(2);}}}},6000);setTimeout(function(){$(".chat-text").css("display","block");$(".chat-text").css({"right":"85px"}).animate({'zoom':1.0},1000,'linear');},6000);$(".chat").click(function(){openChat();if(isFirsttime){isFirsttime=false;getQuestion();}});$(".chat-text").click(function(){openChat();if(isFirsttime){isFirsttime=false;getQuestion();}});$(".chat-cross").click(function(){var r=confirm("Are you sure to leave the chat?");if(r==true){window.location.reload();}});$(".chat-cross-phone").click(function(){var r=confirm("Are you sure to leave the chat?");if(r==true){window.location.reload();}});});function closeChat(){$('.over').removeClass('overlay');$(".chat-cross").css("display","none");$(".chat-message").css("display","none");$(".chat-area").css("display","none");$(".chat").css("display","block");$(".chat-text").css("display","none");}
function openChat(){$('.popup-graybox').on('show.bs.modal',function(e){return e.preventDefault();});$(".notification-count").css("display","none");$(".chat").css("display","none");$(".chat-text").css("display","none");$(".chat-cross").css("display","block");isChatOpen=true;if((getDeviceWidth()<=480)){$(".chat-message").css({"display":"block","right":"0px","bottom":"0px"});$(".chat-cross").css("display","none");}else{$('.over').addClass('overlay');$(".chat-message").css({"display":"block","right":"85px"});}
setTimeout(function(){if((getDeviceWidth()<=480)){$(".chat-area").css({"display":"block","right":"0px","bottom":"0px"});}else{$(".chat-area").css({"display":"block","right":"85px"});}},1000);}
var currentQuestionPosition=0;var hasAnswerGive=true;var questions=[{"id":"0","questions":["Hello","What kind of legal issue are you facing?"],"type":"optional","urlOption":"https://lawrato.com/get-chat-issue","urlData":null},{"id":"1","questions":["What is your %d related to?"],"type":"optional","urlOption":"https://lawrato.com/get-chat-sub-issue",},{"id":"2","questions":["I will send the details of the right lawyers to you.","Can I get your name please?"],"type":"input",},{"id":"3","questions":["And your mobile number, please"],"type":"input",},{"id":"4","questions":["So which city do you need help in?","Type Your City Name"],"type":"optional","urlOption":"https://lawrato.com/get-chat-city","urlData":null},{"id":"5","questions":["So you are looking for legal advice from %s lawyers, right?"],"type":"optional","urlOption":null,"urlData":null,"options":{1:"Yes",2:"No, Some other city"}},{"id":"6","questions":["Select area where you need legal help?","You can skip this question by clicking on <i class='fa fa-step-forward'></i>"],"type":"optional","urlOption":"https://lawrato.com/get-chat-zones"},{"id":"7","questions":["Kindly enter your email id","You can skip this question by clicking on <i class='fa fa-step-forward'></i>"],"type":"input",},{"id":"8","questions":["Any specific details you want to share? Please type them below..","You can skip this question by clicking on <i class='fa fa-step-forward'></i>"],"type":"input",},{"id":"9","questions":["Kindly enter OTP sent on your mobile number to get the lawyer information.<br/><p class ='resend' style='color:blue;cursor: pointer;'><u>Resend OTP?</u></p>"],"type":"input",}];var answers=[];var answerSelected=[];function adjustScreen(currentQuestionPosition,number){var duration=500;$(".message-window").css({height:(number-6)+'%'});$(".list-wrapper").animate({height:(100-number)+'%'},{duration:duration});$(".input-wrapper").animate({bottom:((100-number)+'%')},{duration:duration});}
async function getQuestion(){goBottom();hasAnswerGive=false;var currentQuestion=questions[currentQuestionPosition];var elementClicked;$(".chat-cross-img").click(function(){elementClicked=true;});window.onbeforeunload=function(e){if(currentQuestionPosition>0&&currentQuestionPosition<9){if(elementClicked!=true){e=e||window.event;if(e){e.returnValue='Sure?';}
return 'Sure?';return false;}else{alert("element clicked");}};}
if(currentQuestionPosition>=6&&currentQuestionPosition<=10){$(".input-message").keyup(function(){if($(".input-message").val()!=''){$(".skipButton").css("display","none");$(".sendButton").css("display","block");}else{$(".sendButton").css("display","none");$(".skipButton").css("display","block");}})
if(($('.input-message').prop('disabled'))){$(".skipButton").attr("disabled",true);}
$(".sendButton").css("display","none");$(".skipButton").css("display","block");}
if(currentQuestionPosition<questions.length){for(var i=0;i<currentQuestion.questions.length;i++){var question=currentQuestion.questions[i];$('.message-window').append("<div class='computer-question'><img src='https://lawrato.com/assets/img/chat_loader.gif' class='loading-img'/></div>");goBottom();$('.input-message').prop('disabled',true);$(".sendButton").removeClass("back-white");$(".sendButton").attr("disabled",true);$(".skipButton").attr("disabled",true);if(!($('.input-message').prop('disabled'))){$('.sendButton').attr("disabled",false);$('.skipButton').attr("disabled",false);}
await new Promise(done=>setTimeout(()=>done(),1500));goBottom();if(currentQuestionPosition==1){question=question.replace('%d',answerSelected[currentQuestionPosition-1]);}
if(currentQuestionPosition==5){question=question.replace('%s',$(".city-id").attr("data-info"));}
question=question.replace('%s',answers[currentQuestionPosition-1]);goBottom();$('.message-window .computer-question:last-child').html(question);goBottom();}}else{if(currentQuestionPosition!=10){$('.input-message').prop('disabled',true);$(".sendButton").removeClass("back-white");$(".sendButton").attr("disabled",true);$('.sendButton').css("display","none");$('.skipButton').css("display","none");$('.input-message').prop("placeholder","");}
goBottom();return false;}
if(currentQuestion.type==='input'){if(currentQuestionPosition==3&&getDeviceWidth()<480){$(".input-message").prop('type','tel');}else{$(".input-message").prop('type','text');}
$(".input-message").attr("placeholder","Type here....");$('.input-message').prop('disabled',false).focus();$(".sendButton").addClass("back-white");$(".input-message").keyup(function(){if($(".input-message").val()!=''){$(".sendButton").addClass("send-enabled");$(".sendButton").attr("disabled",false);}else{$(".sendButton").removeClass("send-enabled");$(".sendButton").attr("disabled",true);}})}else{if(currentQuestionPosition==4&&getDeviceWidth()<480){$(".input-message").prop('type','text');}
$(".input-message").attr("placeholder","Choose from the options given below..");$('#chat-area input').val('').prop('disabled',true);$(".sendButton").removeClass("back-white");$(".sendButton").attr("disabled",true);$('.list-wrapper').html('');if(currentQuestion.urlOption!=null){if(currentQuestionPosition==1){var searchTerm=answers?answers[currentQuestionPosition-1]:'';}else if(currentQuestionPosition==4){$(".input-message").keyup(function(){if(currentQuestionPosition==5){var searchCity=$(".input-message").val();$.ajax({url:currentQuestion.urlOption,type:'POST',data:{term:searchCity},success:function(data){$('.list-wrapper').html('');$.each(JSON.parse(data),function(idx,obj){$('.list-wrapper').append('<label class="question-option"><input type="radio" value="'+obj.id+'"> '+obj.text+'</label>');});}});}})}else if(currentQuestionPosition==6){var searchTerm=userCity;$(".input-message").keyup(function(){if(currentQuestionPosition==4){var searchCity2=$(".input-message").val();$.ajax({url:"https://lawrato.com/get-chat-city",type:'POST',data:{term:searchCity2},success:function(data){$('.list-wrapper').html('');$.each(JSON.parse(data),function(idx,obj){$('.list-wrapper').append('<label class="question-option"><input type="radio" value="'+obj.id+'"> '+obj.text+'</label>');});}});}})}else{var searchTerm=currentQuestion.urlData;}
if(currentQuestionPosition==4){goBottom();adjustScreen(currentQuestionPosition,60);$('.input-message').prop('disabled',false).attr("placeholder","Type here....").focus();$(".sendButton").addClass("back-white");}
if(currentQuestionPosition==5){adjustScreen(currentQuestionPosition,85);}
if(currentQuestionPosition==6){$('.input-message').prop('disabled',true).attr("placeholder","Type here....").focus();goBottom();$(".sendButton").addClass("back-white");}
if(currentQuestionPosition==10){adjustScreen(currentQuestionPosition,90);}
if(currentQuestionPosition==7){$('.input-message').prop('disabled',false);}
$.ajax({url:currentQuestion.urlOption,type:'POST',data:{term:searchTerm},success:function(data){$('.list-wrapper').html('');$.each(JSON.parse(data),function(idx,obj){$('.list-wrapper').append('<label class="question-option"><input type="radio" value="'+obj.id+'"> '+obj.text+'</label>');});}});if(currentQuestionPosition==6){adjustScreen(currentQuestionPosition,70);}else if(currentQuestionPosition==5){adjustScreen(currentQuestionPosition,85);}else{adjustScreen(currentQuestionPosition,60)}
goBottom();}else{if(currentQuestionPosition==6){adjustScreen(currentQuestionPosition,70);}else if(currentQuestionPosition==5){adjustScreen(currentQuestionPosition,85);}else{adjustScreen(currentQuestionPosition,60)}
goBottom();$.each(currentQuestion.options,function(id,option){$('.list-wrapper').append('<label class="question-option"><input type="radio" value="'+id+'"> '+option+'</label>');});}}
currentQuestionPosition++;}
$('#send-button').click(function(){var errorMessage='';if(($('.input-message').prop('disabled'))&&($('.input-message').val()=='')){return;}
if($('.input-message').val()!=''){hasAnswerGive=true;}
if(currentQuestionPosition==8){if($('.input-message').val()!=''){answers.push($('.input-message').val());userEmail=$('.input-message').val();if(IsEmail($(".input-message").val())==false){errorMessage="Please enter valid email id";}else{updateEnquiry(userEmail,"email");}}else{userEmail=null;answers.push(null);}}
if(currentQuestionPosition==9){if($('.input-message').val()!=''){userComment=$('.input-message').val();answers.push($('.input-message').val());updateEnquiry(userComment,"comment");}else{userComment='';answers.push(null);}
goBottom();}
if(currentQuestionPosition==10){if($('.input-message').val()==''){showError("Enter OTP to verify your mobile number");}else{var otp=$('.input-message').val();get_expert_detail(isId,otp);}
goBottom();}
var answer=$('.input-message').val();if($('.input-message').val()!=''){$('.message-window').append("<div class='person-reply'>"+answer+"</div>");answers.push(answer);}
if(currentQuestionPosition==3){var name=$(".input-message").val();if($(".input-message").val()==''){errorMessage="Please enter valid name";}else if($.trim(name).length==0){errorMessage="Please enter valid name";}
userName=$('.input-message').val();if(userName.length>20){userName=userName.substring(0,20);}}
if(currentQuestionPosition==4){if($(".input-message").val()==''){errorMessage="Please enter valid mobile number";}else if(($(".input-message").val().length<10||$(".input-message").val().length>15)){errorMessage="Please enter valid mobile number";}else if(isNaN($(".input-message").val())){errorMessage="Please enter valid mobile number";}
userPhone=$('.input-message').val();}
if(currentQuestionPosition==8){$(".input-message").keyup(function(){if($(".input-message").val()!=''){$("#skip_button_icon").css("display","none");$("#send_button_icon").css("display","block");}else{$("#send_button_icon").css("display","none");$("#skip_button_icon").css("display","block");}})
$("#send_button_icon").css("display","none");$("#skip_button_icon").css("display","block");if(IsEmail($(".input-message").val())==false){errorMessage="Please enter valid email id";}}
if(currentQuestionPosition==5){checkCity($('.input-message').val());}else{if(errorMessage!=''){$(".input-message").focus();showError(errorMessage);}
$(".input-message").val('');if(errorMessage==''&&hasAnswerGive){getQuestion();}}});$(document).on('change','.question-option input',function(){adjustScreen(currentQuestionPosition,100);$('.list-wrapper').html('');if(currentQuestionPosition==1){issueId=$(this).val();}
if(currentQuestionPosition==2){subIssueId=$(this).val();}
if(currentQuestionPosition==5){$('.city-id').attr('data-info',$(this).closest('label').text());$('.city-id').val($(this).closest('input').val());userCity=$(".city-id").val();answers.push($(this).val());;$('.message-window').css("height","85%");$('.message-window').append("<div class='person-reply'>"+$(this).closest('label').text()+"</div>");goBottom();getQuestion();}else{if(currentQuestionPosition!=5){answers.push($(this).val());answerSelected.push($(this).closest('label').text());$('.message-window').append("<div class='person-reply'>"+$(this).closest('label').text()+"</div>");}
if(currentQuestionPosition==6){var conformation=$(this).closest('input').val();if(conformation==1){var pageUrl=window.location.href;$.ajax({url:"https://lawrato.com/insert-query-chat",type:'POST',data:{issue_id:issueId,subissue_id:subIssueId,name:userName,phone:userPhone,city:userCity,url:pageUrl},success:function(data){var res=JSON.parse(data);var response=res[0].response;if(response=='success'){var isZone=res[0].iszone;isId=res[0].last_id;if(isZone==0){currentQuestionPosition=currentQuestionPosition+1;getQuestion();}else if(isZone==1){goBottom();getQuestion();}}else if(response=='error'){currentQuestionPosition=15;setTimeout(async function(){$('.message-window').append("<div class='computer-question'><img src='https://lawrato.com/assets/img/chat_loader.gif' class='loading-img'/></div>");goBottom();await new Promise(done=>setTimeout(()=>done(),1500));$('.message-window .computer-question:last-child').html("You will get the details of the lawyers on your email id and mobile number");},2000);setTimeout(async function(){$('.message-window').append("<div class='computer-question'><img src='https://lawrato.com/assets/img/chat_loader.gif' class='loading-img'/></div>");goBottom();await new Promise(done=>setTimeout(()=>done(),1500));$('.message-window .computer-question:last-child').html("Have a good day");},4000);}
$(".sendButton").hide();$(".input-message").prop("placeholder","");}});}else if(conformation==2){$(".city-id").val('');answers.pop();answers.pop();adjustScreen(currentQuestionPosition,100);currentQuestionPosition=currentQuestionPosition-2;}
goBottom();}
if(currentQuestionPosition==7){$(".zone-id").val($(this).closest('input').val());if($(".zone-id").val()==''){userZone='';}else{userZone=$(".zone-id").val();updateEnquiry(userZone,"zone");}}
if(currentQuestionPosition!=6){getQuestion();}}});async function showError(errorMessage){$('.message-window').append("<div class='computer-question'><img src='https://lawrato.com/assets/img/chat_loader.gif' class='loading-img'/></div>");goBottom();await new Promise(done=>setTimeout(()=>done(),1500));$('.message-window .computer-question:last-child').html(errorMessage);return false;}
async function checkCity(checkcity){$.ajax({url:"https://lawrato.com/check-city",type:'POST',data:{city:checkcity},success:function(data){var res=JSON.parse(data);if(res.length==1){var cityNew=res[0].id;$('.city-id').val(cityNew);$('.city-id').attr("data-info",checkcity);userCity=$('.city-id').val();if(userCity!=''){getQuestion();}}else if(res.length==0){errorMessage='Please type correct city name';showError(errorMessage);if(currentQuestionPosition>=answers.length){answers.pop();}
adjustScreen(currentQuestionPosition,60);goBottom();$.ajax({url:"https://lawrato.com/get-chat-city",type:'POST',data:{term:null},success:function(data){$('.list-wrapper').html('');$.each(JSON.parse(data),function(idx,obj){$('.list-wrapper').append('<label class="question-option"><input type="radio" value="'+obj.id+'"> '+obj.text+'</label>');});}});}}});return false;}
function sleep(time){var start=Date.now();now=start;while(now-start<time){now=Date.now();}}
function goBottom(){var elem=document.getElementById('message-window');elem.scrollTop=elem.scrollHeight;}
function updateEnquiry(updateTerm,type){var pageUrl=window.location.href;$.ajax({url:"https://lawrato.com/update-enquiry",type:'POST',data:{id:isId,term:updateTerm,type:type},success:function(data){}});return true;}
$("#skip_button_icon").click(function(){$('#skip_button_icon').hide();setTimeout(function(){$('#skip_button_icon').show();},2000);if(currentQuestionPosition==7){userZone=null;}else if(currentQuestionPosition==8){userEmail=null;}else if(currentQuestionPosition==9){userComment=null;updateEnquiry(userComment,"comment");}else if(currentQuestionPosition==10){if($('.input-message').val()==''){showError("Enter OTP to verify your mobile number");}else{var otp=$('.input-message').val();get_expert_detail(isId,otp);}}
currentQuestionPosition=currentQuestionPosition++;answers.push(null);$(".list-wrapper").html('');adjustScreen(currentQuestionPosition,99);getQuestion();goBottom();})
function IsEmail(email){var regex=/^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;if(!regex.test(email)){return false;}else{return true;}}
$(".input-message").focus(function(){if(getDeviceWidth()<480){goBottom();}});$(window).on('resize',function(){$(".message-window").css("padding-bottom","30px");goBottom();});function get_expert_detail(id,otp){$.ajax({url:"https://lawrato.com/get-chat-lawyer-detail",type:'POST',data:{lastId:id,otp:otp},success:function(data){if(data=='otperror'){errorMessage="Incorrect OTP! Kindly enter correct OTP to get lawyer detail.<br/><p class ='resend' style='color:blue;cursor: pointer;'><u>Resend OTP?</u></p>";showError(errorMessage);goBottom();}else{if(data!=''){var res=JSON.parse(data);setTimeout(function(){var text="You can contact <b>"+res[0].disply_name+"</b> on <a href='tel:"+res[0].mobile_number+"'><b>"+res[0].mobile_number+"</b></a> for your legal issue";showMessage(text);setTimeout(function(){var text="Lawyer details have been sent to your email id and mobile number";showMessage(text);setTimeout(function(){var text="Have a good day";showMessage(text);setTimeout(function(){closeChat();},15000);},2000);},2000);},2000);}else{setTimeout(function(){var text="Thank you for sharing your legal issue with us";showMessage(text);setTimeout(function(){var text="We will contact you shortly to share the lawyer details with you";showMessage(text);setTimeout(function(){var text="Have a good day";showMessage(text);setTimeout(function(){closeChat();},15000);},2000);},2000);},2000);}
$('.input-message').prop('disabled',true);$(".sendButton").removeClass("back-white");$(".sendButton").attr("disabled",true);$('.sendButton').css("display","none");$('.skipButton').css("display","none");$('.input-message').prop("placeholder","");}}});}
async function showMessage(Message){$('.message-window').append("<div class='computer-question'><img src='https://lawrato.com/assets/img/chat_loader.gif' class='loading-img'/></div>");goBottom();await new Promise(done=>setTimeout(()=>done(),1000));$('.message-window .computer-question:last-child').html(Message);return false;}
function getDeviceWidth(){return $(window).width();}
$(document).ready(function(){$(document).on('click','.resend',function(){$.ajax({url:"https://lawrato.com/resend-otp",type:'POST',data:{id:isId},success:function(data){if(data=='success'){showMessage("OTP has been sent to your mobile number kindly check");}else{showMessage("Problem sending OTP");}}});});})